{"version":3,"sources":["workshop/cartes/Carte-1.js","configuration/transferData.js","workshop/rubriques/Rubrique-1.js","configuration/adhoc.js","configuration/App.js","index.js"],"names":["Carte","_ref","description","image","React","createElement","style","width","height","background","marginRight","value","marginTop","marginLeft","src","TransferData","_this","_classCallCheck","listTitle","myData","list","suggestion","pseudo","title","transfer","data","download","newData","filter","item","suggested","map","datum","votes","find","vote","_createClass","key","get","this","decorate","observable","computed","createContext","Rubrique","className","httpLink","HttpLink","uri","wsLink","WebSocketLink","options","reconnect","link","split","query","_getMainDefinition","getMainDefinition","kind","operation","client","ApolloClient","cache","InMemoryCache","GET_CONTENT","gql","_templateObject","_taggedTemplateLiteral","NEWPLACE_SUBSCRIPTION","_templateObject2","ADD_CONTENT","_templateObject3","DELETE_CONTENT","_templateObject4","Query","_data$Place","useContext","transferData","useQuery","contents","Place","Contents","useEffect","Fragment","Subscription","_data$newPlace","useSubscription","newPlace","Mutation","_useState","useState","_useState2","_slicedToArray","setListTitle","_useMutation","useMutation","addContent","_useMutation3","deleteContent","color","minWidth","borderRadius","padding","onClick","length","_newData$myData","checkData","_item$description","_item$image","forEach","i","variables","alert","Adhoc","ApolloProvider","App","observer","dataContext","setData","overflow","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.17c3e530.chunk.js","sourcesContent":["import React from \"react\";\n\nexport default function Carte({ description, image }) {\n  return (\n    <div\n      style={{\n        width: 170,\n        height: 300,\n        background: \"#A9A9A9\",\n        marginRight: 50\n      }}\n    >\n      <textarea value={description} style={{ marginTop: 10 }} />\n      <img\n        style={{ width: 140, marginRight: 13, marginLeft: 13, marginTop: 10 }}\n        src={image}\n      />\n    </div>\n  );\n}\n","import { createContext } from \"react\";\nimport { decorate, observable, computed } from \"mobx\";\n\nclass TransferData {\n  listTitle = \"\";\n\n  myData = [];\n\n  list = [];\n  suggestion = null;\n\n  get data() {\n    return this.list;\n  }\n\n  pseudo = (title) => {\n    this.listTitle = title;\n  };\n\n  transfer = (data) => {\n    this.myData = data;\n  };\n\n  download = (data) => {\n    let newData = data.filter((item) => !item.suggested);\n\n    newData.map((item) => {\n      const datum = item.votes.find((item) => item.pseudo === this.listTitle);\n      item.vote = datum ? datum.vote : 0;\n    });\n\n    this.list = newData;\n\n    this.suggestion = data.find(\n      (item) => item.suggested && item.pseudo === this.listTitle\n    );\n  };\n}\n\ndecorate(TransferData, {\n  list: observable,\n  data: computed\n});\n\nconst data = new TransferData();\n\nexport default createContext(data);\n","import React, { useState } from \"react\";\nimport Carte from \"../cartes/Carte-1.js\";\nimport PourVoter from \"../PourVoter\";\n\nexport default function Rubrique({ data }) {\n  return (\n    <div className=\"scroll\">\n      <div className=\"liste scroll\">\n        <Carte\n          image=\"https://www.leparisien.fr/resizer/gdqi_4JFFkliiZPPncb_5oHzXAI=/932x582/cloudfront-eu-central-1.images.arcpublishing.com/lpguideshopping/G6AD3X2NPRHPTNBAIZMAC5OF6I.jpg\"\n          description=\"La nouvelle série du seigneur des anneaux disponible maintenant sur amazon\"\n        />\n\n        <Carte\n          image=\"https://fr.web.img4.acsta.net/pictures/22/02/03/16/28/1554715.jpg\"\n          description=\"La nouvelle série du seigneur des anneaux disponible maintenant sur amazon\"\n        />\n      </div>\n    </div>\n  );\n}\n","import React, { useState, useEffect, useContext } from \"react\";\n\nimport { gql } from \"apollo-boost\";\nimport {\n  ApolloProvider,\n  useQuery,\n  useMutation,\n  useSubscription\n} from \"@apollo/react-hooks\";\nimport { ApolloClient } from \"apollo-client\";\nimport { InMemoryCache } from \"apollo-cache-inmemory\";\nimport { WebSocketLink } from \"apollo-link-ws\";\nimport { split } from \"apollo-link\";\nimport { HttpLink } from \"apollo-link-http\";\nimport { getMainDefinition } from \"apollo-utilities\";\n\nimport transferData from \"./transferData\";\n\nconst httpLink = new HttpLink({\n  // uri: 'http://localhost:4000/graphql'\n  uri: \"https://adhoc-workshops.herokuapp.com/graphql\"\n});\n\nconst wsLink = new WebSocketLink({\n  // uri: `ws://localhost:4000/graphql`,\n  uri: `wss://adhoc-workshops.herokuapp.com/graphql`,\n  options: {\n    reconnect: true\n  }\n});\n\nconst link = split(\n  ({ query }) => {\n    const { kind, operation } = getMainDefinition(query);\n    return kind === \"OperationDefinition\" && operation === \"subscription\";\n  },\n  wsLink,\n  httpLink\n);\n\nconst client = new ApolloClient({\n  link: link,\n  cache: new InMemoryCache()\n});\n\nconst GET_CONTENT = gql`\n  query {\n    Place(id: \"Wifilles-2021\") {\n      Contents {\n        list\n        description\n        image\n        votes {\n          pseudo\n          vote\n        }\n        pseudo\n        suggested\n      }\n    }\n  }\n`;\n\nconst NEWPLACE_SUBSCRIPTION = gql`\n  subscription {\n    newPlace(placeId: \"Wifilles-2021\") {\n      Contents {\n        list\n        description\n        image\n        votes {\n          pseudo\n          vote\n        }\n        pseudo\n        suggested\n      }\n    }\n  }\n`;\n\nconst ADD_CONTENT = gql`\n  mutation AddContent(\n    $list: String!\n    $pseudo: String!\n    $description: String!\n    $image: String!\n    $vote: Float!\n  ) {\n    addContent(\n      list: $list\n      pseudo: $pseudo\n      description: $description\n      image: $image\n      vote: $vote\n      place_id: \"Wifilles-2021\"\n    ) {\n      list\n    }\n  }\n`;\n\nconst DELETE_CONTENT = gql`\n  mutation AddContent($list: String!) {\n    deleteContent(list: $list, place_id: \"Wifilles-2021\") {\n      list\n    }\n  }\n`;\n\nfunction Query() {\n  const newData = useContext(transferData);\n\n  const { data } = useQuery(GET_CONTENT);\n  let contents = data?.Place?.Contents;\n\n  // console.log(\"Data from Server Query\", data);\n\n  useEffect(() => {\n    if (contents) newData.download(contents);\n    // eslint-disable-next-line\n  }, [contents]);\n\n  return <></>;\n}\n\nfunction Subscription() {\n  const newData = useContext(transferData);\n  const { data } = useSubscription(NEWPLACE_SUBSCRIPTION);\n\n  // console.log(\"Data from Server Subscription\", data);\n\n  let contents = data?.newPlace?.Contents;\n\n  useEffect(() => {\n    if (contents) newData.download(contents);\n    // eslint-disable-next-line\n  }, [contents]);\n\n  return <></>;\n}\n\nfunction Mutation() {\n  const newData = useContext(transferData);\n\n  const [listTitle, setListTitle] = useState();\n\n  const [addContent] = useMutation(ADD_CONTENT);\n  const [deleteContent] = useMutation(DELETE_CONTENT);\n\n  useEffect(() => {\n    setListTitle(newData.listTitle);\n  }, [newData.listTitle]);\n\n  function addData() {\n    if (!newData.myData.length) {\n      alert(\"Merci de transférer d'abord des Données !\");\n    } else {\n      const checkData = newData.myData.filter(\n        (item) => item.description?.length && item.image?.length\n      );\n\n      if (newData?.myData?.length === checkData.length) {\n        newData.myData.forEach((item, i) =>\n          addContent({\n            variables: {\n              list: item.list ? item.list : listTitle,\n              pseudo: listTitle,\n              description: item.description,\n              image: item.image,\n              vote: item.vote ? item.vote : 0\n            }\n          })\n        );\n      } else {\n        alert(\n          'Merci de vérifier si les Données contiennent bien : \"description\" et \"image\" !'\n        );\n      }\n    }\n  }\n\n  function deleteData() {\n    if (!listTitle) {\n      alert(\"Merci d'entrer d'abord votre ListTitle !\");\n    } else {\n      deleteContent({\n        variables: {\n          list: listTitle\n        }\n      });\n    }\n  }\n\n  return (\n    <div className=\"navbar\">\n      {listTitle && (\n        <>\n          <h4\n            style={{\n              color: \"#5F9EA0\",\n              background: \"#FFF\",\n              minWidth: 200,\n              borderRadius: 5,\n              padding: 4,\n              marginRight: 12\n            }}\n          >\n            {listTitle}\n          </h4>\n          <button className=\"send\" onClick={addData}>\n            Envoyer\n          </button>\n          <button className=\"delete\" onClick={deleteData}>\n            Effacer\n          </button>\n        </>\n      )}\n    </div>\n  );\n}\n\nfunction Adhoc() {\n  return (\n    <ApolloProvider client={client}>\n      <Query />\n      <Subscription />\n      <Mutation />\n    </ApolloProvider>\n  );\n}\n\nexport default Adhoc;\n","import Rubrique from \"../workshop/rubriques/Rubrique-1\";\n\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { observer } from \"mobx-react-lite\";\n\nimport Adhoc from \"./adhoc\";\nimport transferData from \"./transferData\";\n\nconst App = observer(() => {\n  const dataContext = useContext(transferData);\n  const [data, setData] = useState(dataContext);\n\n  useEffect(() => {\n    setData(dataContext);\n    // eslint-disable-next-line\n  }, [dataContext.list]);\n\n  return (\n    <div className=\"scroll\" style={{ overflow: \"auto\", height: \"100vh\" }}>\n      <Adhoc />\n      <div className=\"App\">\n        <Rubrique data={data} />\n      </div>\n    </div>\n  );\n});\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./configuration/App\";\nimport \"./configuration/App.css\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}